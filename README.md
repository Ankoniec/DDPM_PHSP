## DDPM - denoising diffusion probabilistic model
An implementation of the denoising diffusion probabilistic model for generating the phase space of medical linacs. Project created as part of a master's thesis entitled: "A novel approach for generating medical linac phase space using diffusion deep neural model". The aim of the thesis was to create generative neural network model that produce the most realistic cases of medical accelerator phase spaces. 

Data directory contains phase spaces generated by Monte Carlo simulation which was made available by the International Atomic Energy Agency.
- photons_E5.7_s2.0_a1.5.npy - is a file with raw photons data with the initial beam energy (E) of 5.7 MeV, focus size (s) of 2.0 mm and angular divergence (a) of 1.5 degree
- photons_XY_cut_E5.7_s2.0_a1.5.npy - contains data with photons filtered below -50 cm and above 50 cm position on X and Y axes
- photons_XY_theta_cut_E5.7_s2.0_a1.5.npy - contains data with filter on X and Y coordinates and on theta variable (deflection angle in respect to Z axis which is parallel to the direction of the beam) above 80 degrees


### Technologies

* Python 3.10.5
* PyTorch 1.12.1
* PyTorch Lightning 1.7.7
* NumPy 1.23.3
* SciPy 1.9.1
* Matplotlib 3.6.1
* Pandas 1.5.0
* Jupyter 1.0.0


### How to start training of the model

1. Complete the configuration file (ddpm_config.yaml) with the relevant data
2. Execute file "DDPM_lit.py" with command "python DDPM_lit.py"

### How to generate phase space

1. Open "DDPM_load_ckpt.ipynb"
2. Copy name of the checkpoint file and paste it in the second cell where the model is loaded from checkpoint
3. Run the cells one by one in Jupyter notebook